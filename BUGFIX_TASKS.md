# CRM Bug Fix Specification
> –î–ª—è Claude Code ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø–æ –∫–æ–∂–Ω–æ–º—É –±–∞–≥—É

---

## –ó–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **CRM URL:** https://8223324090-production.up.railway.app
- **–°—Ç–µ–∫:** (—É—Ç–æ—á–Ω–∏—Ç–∏ ‚Äî React/Next.js/Vue? Node.js backend?)
- **–î–µ–ø–ª–æ–π:** Railway

---

## BUG-001 ¬∑ –¢—ñ–º—É—Ä: –∑–∞–π–≤–∏–π —Ç–µ–∫—Å—Ç –ø—Ä–∏ –≤—ñ–¥–º—ñ–Ω—ñ
**–§–∞–π–ª:** `tymur-bot/bot.py`
**–§—É–Ω–∫—Ü—ñ—è:** `handle_callback` ‚Üí `action == "decline"`

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "‚õî –°—å–æ–≥–æ–¥–Ω—ñ –Ω–µ –ø—Ä–∞—Ü—é—é" –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```
–ü—Ä–∏–≤—ñ—Ç! –î—Ä—É–∫ –ø—ñ–Ω—å—è—Ç–∏ üñ®Ô∏è
‚Ä¢ ID: ...
...
–û–±–µ—Ä–∏ —á–∞—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ üëá   ‚Üê –¶–ï–ô –†–Ø–î–û–ö –ó–ê–ô–í–ò–ô

‚õî –ó—Ä–æ–∑—É–º—ñ–ª–æ, –¥—è–∫—É—é!
```

**–ü—Ä–∏—á–∏–Ω–∞:** `query.message.text` –º—ñ—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫ "–û–±–µ—Ä–∏ —á–∞—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ üëá",
–∞ –∫–æ–¥ –ø—Ä–æ—Å—Ç–æ –¥–æ–ø–∏—Å—É—î `"\n\n‚õî –ó—Ä–æ–∑—É–º—ñ–ª–æ, –¥—è–∫—É—é!"` –≤ –∫—ñ–Ω–µ—Ü—å.

**–§—ñ–∫—Å:**
```python
# –ë–£–õ–û:
await query.edit_message_text(query.message.text + "\n\n‚õî –ó—Ä–æ–∑—É–º—ñ–ª–æ, –¥—è–∫—É—é!")

# –¢–†–ï–ë–ê ‚Äî –æ–±—Ä—ñ–∑–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫ –ø–µ—Ä–µ–¥ –¥–æ–ø–∏—Å—É–≤–∞–Ω–Ω—è–º:
original_text = "\n".join(query.message.text.split("\n")[:-1]).rstrip()
await query.edit_message_text(original_text + "\n\n‚õî –ó—Ä–æ–∑—É–º—ñ–ª–æ, –¥—è–∫—É—é!")
```

–¢–µ —Å–∞–º–µ –∑—Ä–æ–±–∏—Ç–∏ –¥–ª—è `action == "other"` (—Ç–∞–∫–æ–∂ –¥–æ–ø–∏—Å—É—î –¥–æ —Ç–µ–∫—Å—Ç—É –∑ "–û–±–µ—Ä–∏...").

---

## CRM-UI-001 ¬∑ –¢–∞–π–º–ª–∞–π–Ω ‚Äî –Ω–µ–º–∞—î –¥–Ω—è —Ç–∏–∂–Ω—è

**–î–µ:** –í–µ–±-CRM ‚Üí —Å—Ç–æ—Ä—ñ–Ω–∫–∞ Timeline/–†–æ–∑–∫–ª–∞–¥

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–∞ –º–æ–±—ñ–ª—å–Ω–æ–º—É —É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ –≤–∞–∂–∫–æ —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ –¥–∞—Ç–∏ ‚Äî –Ω–µ–º–∞—î –¥–Ω—è —Ç–∏–∂–Ω—è.

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–∏–≥–ª—è–¥:**
```
–ë–£–õ–û:    21.02
–¢–†–ï–ë–ê:   –ü–Ω, 21.02
         –∞–±–æ
         –ü–æ–Ω–µ–¥—ñ–ª–æ–∫, 21 –ª—é—Ç–æ–≥–æ
```

**–§—ñ–∫—Å:**
–ó–Ω–∞–π—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥–æ–ª–æ–≤–∫—É —Ç–∞–π–º–ª–∞–π–Ω—É (–∑–∞–∑–≤–∏—á–∞–π `TimelineHeader`, `DayColumn`, `CalendarHeader` –∞–±–æ —Å—Ö–æ–∂–∏–π).
–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–Ω—è —Ç–∏–∂–Ω—è:

```javascript
// JavaScript/React –ø—Ä–∏–∫–ª–∞–¥
const formatDate = (date) => {
  const days = ['–ù–¥', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];
  const dayName = days[date.getDay()];
  const day = date.getDate().toString().padStart(2, '0');
  const month = (date.getMonth() + 1).toString().padStart(2, '0');
  return `${dayName}, ${day}.${month}`;
};

// –ê–±–æ —á–µ—Ä–µ–∑ Intl:
const formatDate = (date) => {
  return new Intl.DateTimeFormat('uk-UA', {
    weekday: 'short',
    day: '2-digit',
    month: '2-digit'
  }).format(date);
};
```

---

## CRM-UI-002 ¬∑ –ö–∞–ª–µ–Ω–¥–∞—Ä –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –ù–µ–¥—ñ–ª—ñ

**–î–µ:** –í–µ–±-CRM ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ö–∞–ª–µ–Ω–¥–∞—Ä—è (–º—ñ—Å—è—á–Ω–∏–π –≤–∏–≥–ª—è–¥)

**–ü—Ä–æ–±–ª–µ–º–∞:**
–¢–∏–∂–¥–µ–Ω—å –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –ù–µ–¥—ñ–ª—ñ (–∞–º–µ—Ä–∏–∫–∞–Ω—Å—å–∫–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç).
–í –£–∫—Ä–∞—ó–Ω—ñ/–Ñ–≤—Ä–æ–ø—ñ —Ç–∏–∂–¥–µ–Ω—å –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –ü–æ–Ω–µ–¥—ñ–ª–∫–∞.

**–§—ñ–∫—Å (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏):**

```javascript
// react-calendar:
<Calendar locale="uk-UA" />
// (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ü–Ω –ø–µ—Ä—à–∏–º –¥–ª—è uk-UA)

// fullcalendar:
<FullCalendar firstDay={1} />
// 0=–ù–µ–¥—ñ–ª—è, 1=–ü–æ–Ω–µ–¥—ñ–ª–æ–∫

// date-fns (—è–∫—â–æ –≤–ª–∞—Å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è):
import { startOfWeek } from 'date-fns';
import { uk } from 'date-fns/locale';
startOfWeek(date, { locale: uk }); // –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ü–Ω

// react-big-calendar:
<BigCalendar culture="uk" />

// –í–ª–∞—Å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ‚Äî –º–∞—Å–∏–≤ –¥–Ω—ñ–≤:
// –ë–£–õ–û:
const DAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
// –¢–†–ï–ë–ê:
const DAYS = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–ù–¥'];
// —ñ –∑–º—ñ—â–µ–Ω–Ω—è: (dayIndex + 6) % 7
```

**–ó–Ω–∞–π—Ç–∏:** –ø–æ—à—É–∫ –ø–æ –∫–æ–¥—É `firstDay`, `startOfWeek`, `weekdays`, `['Sun'` –∞–±–æ `['–ù–¥'`.

---

## CRM-VAL-001 ¬∑ –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è ‚Äî –º–æ–∂–Ω–∞ –æ–±—Ä–∞—Ç–∏ –º–∏–Ω—É–ª—É –¥–∞—Ç—É

**–î–µ:** –í–µ–±-CRM ‚Üí —Ñ–æ—Ä–º–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è/–ø–æ–¥—ñ—ó

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ú–æ–∂–Ω–∞ –æ–±—Ä–∞—Ç–∏ –±—É–¥—å-—è–∫—É –¥–∞—Ç—É/—á–∞—Å —É –º–∏–Ω—É–ª–æ–º—É —ñ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–æ–¥—ñ—é.

**–§—ñ–∫—Å ‚Äî –§—Ä–æ–Ω—Ç–µ–Ω–¥ (date picker):**
```javascript
// –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –º–∏–Ω—É–ª—ñ –¥–∞—Ç–∏ –≤ date picker:

// react-datepicker:
<DatePicker
  minDate={new Date()}
  filterTime={(time) => time >= new Date()}
/>

// –í–ª–∞—Å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—Ä–∏ submit:
const validateDateTime = (selectedDateTime) => {
  if (selectedDateTime < new Date()) {
    return '–û–±—Ä–∞–Ω–∞ –¥–∞—Ç–∞ –≤–∂–µ –º–∏–Ω—É–ª–∞. –û–±–µ—Ä—ñ—Ç—å –º–∞–π–±—É—Ç–Ω—é –¥–∞—Ç—É.';
  }
  return null;
};
```

**–§—ñ–∫—Å ‚Äî –ë–µ–∫–µ–Ω–¥ (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ!):**
```javascript
// Node.js/Express ‚Äî –≤ route –æ–±—Ä–æ–±–Ω–∏–∫—É POST /bookings –∞–±–æ POST /events:
const createBooking = async (req, res) => {
  const { startDateTime } = req.body;
  
  if (new Date(startDateTime) < new Date()) {
    return res.status(400).json({
      error: '–ù–µ–º–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–¥—ñ—é –≤ –º–∏–Ω—É–ª–æ–º—É',
      code: 'PAST_DATE_NOT_ALLOWED'
    });
  }
  
  // ... —Ä–µ—à—Ç–∞ –ª–æ–≥—ñ–∫–∏
};
```

**–í–∞–∂–ª–∏–≤–æ:** –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —ñ –¥–∞—Ç—É —ñ —á–∞—Å ‚Äî –Ω–µ —Ç—ñ–ª—å–∫–∏ –¥–∞—Ç—É! 
–¢–æ–±—Ç–æ —Å—å–æ–≥–æ–¥–Ω—ñ –æ 10:00 –≤–∂–µ –º–∏–Ω—É–ª–∞, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—è –¥–∞—Ç–∞ —â–µ "–≤–∞–ª—ñ–¥–Ω–∞".

---

## CRM-BUG-002 ¬∑ –ö–Ω–æ–ø–∫–∞ "–ê—Ñ—ñ—à–∞" –≤ –º–µ–Ω—é –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è

**–î–µ:** –í–µ–±-CRM ‚Üí "‚â° –ú–µ–Ω—é" ‚Üí –ø—É–Ω–∫—Ç "–ê—Ñ—ñ—à–∞"

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –ø—É–Ω–∫—Ç "–ê—Ñ—ñ—à–∞" —É –±—ñ—á–Ω–æ–º—É –º–µ–Ω—é –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å.
–ú—ñ–∂ "–î–∞–π–¥–∂–µ—Å—Ç" —ñ "–ü—Ä–æ–≥—Ä–∞–º–∏".

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (—â–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏):**
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ DevTools ‚Üí Console ‚Äî —á–∏ —î JS –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∫–ª—ñ–∫—É?
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ—É—Ç ‚Äî —á–∏ —ñ—Å–Ω—É—î `/afisha` –∞–±–æ `/poster` —Ä–æ—É—Ç –≤ —Ä–æ—É—Ç–µ—Ä—ñ?
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ onClick handler –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ –º–µ–Ω—é ‚Äî —á–∏ –≤—ñ–Ω –≤–∑–∞–≥–∞–ª—ñ —î?

**–¢–∏–ø–æ–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
```javascript
// –í–∞—Ä—ñ–∞–Ω—Ç –ê ‚Äî —Ä–æ—É—Ç –Ω–µ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ:
// –ó–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª —Ä–æ—É—Ç–µ—Ä–∞ (App.jsx, router.js, routes.ts) —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:
<Route path="/afisha" component={AfishaPage} />
// –Ø–∫—â–æ –Ω–µ–º–∞—î ‚Äî –¥–æ–¥–∞—Ç–∏

// –í–∞—Ä—ñ–∞–Ω—Ç –ë ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —ñ—Å–Ω—É—î:
// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —ñ—Å–Ω—É—î —Ñ–∞–π–ª AfishaPage.jsx/tsx
// –Ø–∫—â–æ –Ω—ñ ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≥–ª—É—à–∫—É:
const AfishaPage = () => <div>–ê—Ñ—ñ—à–∞ ‚Äî –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ</div>;

// –í–∞—Ä—ñ–∞–Ω—Ç –í ‚Äî onClick –Ω–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π:
// –ó–Ω–∞–π—Ç–∏ –ø—É–Ω–∫—Ç –º–µ–Ω—é "–ê—Ñ—ñ—à–∞" –≤ –∫–æ–¥—ñ —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:
<MenuItem onClick={() => navigate('/afisha')}>–ê—Ñ—ñ—à–∞</MenuItem>
// –Ø–∫—â–æ navigate –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è ‚Äî –≤–∏–ø—Ä–∞–≤–∏—Ç–∏

// –í–∞—Ä—ñ–∞–Ω—Ç –ì ‚Äî –ø–æ–º–∏–ª–∫–∞ —ñ–º–ø–æ—Ä—Ç—É (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —î, –∞–ª–µ –∫—Ä–∞—à–∏—Ç—å—Å—è):
// DevTools ‚Üí Console –ø–æ–∫–∞–∂–µ –ø–æ–º–∏–ª–∫—É
```

**–ü–æ—à—É–∫ –≤ –∫–æ–¥—ñ:**
```bash
grep -r "–ê—Ñ—ñ—à–∞\|afisha\|Afisha\|poster\|Poster" src/ --include="*.tsx" --include="*.jsx" --include="*.ts" --include="*.js"
```

---

## –ü–æ—Ä—è–¥–æ–∫ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π)

1. **BUG-001** (–¢–∏–º—É—Ä/decline) ‚Äî 5 —Ö–≤, –ø—Ä–æ—Å—Ç–∏–π —Ñ—ñ–∫—Å
2. **CRM-VAL-001** (–º–∏–Ω—É–ª–∞ –¥–∞—Ç–∞) ‚Äî 30 —Ö–≤, —Ñ—Ä–æ–Ω—Ç + –±–µ–∫–µ–Ω–¥
3. **CRM-BUG-002** (–ê—Ñ—ñ—à–∞) ‚Äî 15-30 —Ö–≤, –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø—Ä–∏—á–∏–Ω–∏
4. **CRM-UI-002** (–∫–∞–ª–µ–Ω–¥–∞—Ä –ü–Ω) ‚Äî 15 —Ö–≤, –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
5. **CRM-UI-001** (—Ç–∞–π–º–ª–∞–π–Ω –¥–µ–Ω—å —Ç–∏–∂–Ω—è) ‚Äî 20 —Ö–≤

**–ó–∞–≥–∞–ª—å–Ω–∏–π —á–∞—Å:** ~1.5-2 –≥–æ–¥–∏–Ω–∏
