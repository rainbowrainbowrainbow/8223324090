/**
 * responsive.css - All media queries — v4.0 redesign
 */

/* ==========================================
   DESKTOP TOOLBAR (>=769px) — v5.35 two-row grid
   ========================================== */

@media (min-width: 769px) {
    .control-panel {
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 10px 16px;
        align-items: center;
    }
    .date-controls { grid-column: 1; grid-row: 1; }
    .status-filter-controls { grid-column: 2; grid-row: 1; justify-self: center; }
    .view-mode-controls { grid-column: 3; grid-row: 1; }
    .v32-controls { grid-column: 1 / span 2; grid-row: 2; }
    .action-buttons { grid-column: 3; grid-row: 2; justify-self: end; }
}

/* v5.35: Backdrop fade-in animation */
@keyframes backdropFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* ==========================================
   TABLET (<=1024px)
   ========================================== */

@media (max-width: 1024px) {
    .main-content.panel-open { padding-right: 24px; }

    /* v5.35: Panel backdrop — semi-transparent overlay */
    .panel-backdrop:not(.hidden) {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.4);
        z-index: 89;
        backdrop-filter: blur(2px);
        animation: backdropFadeIn var(--speed-normal) var(--ease-smooth);
    }

    /* v5.35: Panel overlay (not full-width) */
    .booking-panel {
        width: 380px;
        top: 0;
        height: 100vh;
    }

    /* v5.33: Lock body scroll when panel is open on mobile */
    body.panel-open {
        overflow: hidden;
    }

    /* v5.35: Tablet program grid — 5 columns */
    .category-grid { grid-template-columns: repeat(5, 1fr); }

    /* v5.35: Tablet modals — not full screen */
    .modal-content { max-width: 90%; }
    .modal-large { max-width: 90%; }
    .modal-catalog { max-width: 90%; max-height: 90vh; }
}

/* ==========================================
   MOBILE (<=768px)
   ========================================== */

@media (max-width: 768px) {
    /* v7.8.6: Prevent horizontal scroll on mobile */
    html, body {
        overflow-x: hidden;
    }

    .header-content {
        padding: 12px 16px;
        overflow: hidden;
    }
    .logo-text h1 { font-size: 14px; }

    .main-content { padding: 12px; }

    /* v7.8.3: Toolbar — CSS Grid with explicit 3 rows */
    .control-panel {
        display: grid;
        grid-template-columns: 1fr auto;
        grid-template-rows: auto auto auto;
        gap: 6px;
        padding: 10px 12px;
        margin-bottom: 10px;
        overflow: hidden;
        max-width: 100%;
    }

    /* v5.35: Panel full-width on mobile */
    .booking-panel { width: 100%; }

    /* v7.8.3: Row 1 — Date navigation (full width) */
    .date-controls {
        grid-column: 1 / -1;
        grid-row: 1;
        display: flex;
        justify-content: center;
        flex-wrap: nowrap;
        gap: 6px;
    }

    .date-controls .btn-nav {
        width: 40px;
        height: 38px;
        min-width: 40px;
        flex-shrink: 0;
    }

    .date-controls input[type="date"] {
        flex: 1;
        min-width: 0;
        padding: 8px 6px;
        font-size: 16px; /* >= 16px prevents iOS auto-zoom on focus */
    }

    .date-controls .day-info {
        flex: 0 0 auto;
    }

    .day-label {
        padding: 4px 8px;
        font-size: 11px;
    }

    /* v7.8.3: Row 2 — Status filter + Period selector */
    .status-filter-controls {
        grid-column: 1;
        grid-row: 2;
        min-width: 0;
        justify-content: center;
    }

    .status-filter-btn {
        flex: 1;
        text-align: center;
        padding: 6px 4px;
        font-size: 10px;
        min-height: 36px;
        min-width: 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .view-mode-controls {
        grid-column: 2;
        grid-row: 2;
        min-width: 0;
    }

    .period-btn {
        font-size: 10px;
        padding: 6px 8px;
        min-height: 36px;
    }

    /* v7.8.3: Row 3 — Zoom + toggles + action buttons */
    .v32-controls {
        grid-column: 1;
        grid-row: 3;
        min-width: 0;
        justify-content: flex-start;
        flex-wrap: nowrap;
    }

    .action-buttons {
        grid-column: 2;
        grid-row: 3;
        display: flex;
        gap: 4px;
        justify-self: end;
        align-self: center;
    }

    .zoom-controls .zoom-btn {
        padding: 6px 8px;
        font-size: 10px;
        min-height: 36px;
    }

    .toggle-mini {
        font-size: 13px;
        padding: 4px 6px;
        min-height: 36px;
    }

    /* v5.15: Today button mobile */
    .btn-today {
        padding: 6px 10px;
        font-size: 11px;
        min-height: 38px;
    }

    .timeline-scroll { padding: 12px; }
    .time-scale { margin-left: 90px; }
    .line-header { width: 90px; min-width: 90px; }
    .line-name { font-size: 12px; }

    .user-panel { gap: 8px; }
    .btn-logout {
        padding: 8px 12px;
        font-size: 12px;
    }

    /* v7.8.6: Booking panel — compact on mobile */
    .panel-header {
        padding: 12px 14px;
    }

    .panel-header h3 {
        font-size: var(--font-base);
    }

    .booking-form {
        padding: 12px 14px;
    }

    .selected-info {
        padding: 10px 12px;
        margin-bottom: 12px;
    }

    .info-item {
        margin-bottom: 5px;
    }

    .info-label { font-size: 12px; }
    .info-value { font-size: 13px; }

    .form-section {
        margin-bottom: 12px;
    }

    .form-section label {
        margin-bottom: 5px;
        font-size: 11px;
    }

    .form-section select,
    .form-section input {
        padding: 9px 10px;
        font-size: 16px; /* >= 16px prevents iOS auto-zoom */
        border-width: 1.5px;
    }

    .program-search-input {
        padding: 8px 10px;
        font-size: 16px;
        border-width: 1.5px;
    }

    .program-details {
        padding: 10px 12px;
        margin-bottom: 12px;
    }

    .custom-program-section,
    .second-animator-section,
    .extra-host-section,
    .kids-count-section {
        padding: 10px 12px;
        margin-bottom: 12px;
    }

    .extra-host-section .toggle-label {
        font-size: 12px;
        gap: 8px;
    }

    .extra-host-section select {
        margin-top: 8px;
        padding: 8px;
    }

    .hosts-warning {
        padding: 10px 12px;
        margin-bottom: 12px;
        font-size: 11px;
    }

    .kids-count-section input {
        padding: 8px;
    }

    .category-header {
        font-size: 10px;
        padding: 6px 0 3px;
    }

    .program-icon {
        padding: 8px 4px;
        min-height: 64px;
        border-radius: 10px;
    }

    .program-icon .icon {
        font-size: 22px;
        margin-bottom: 4px;
    }

    .program-icon .name {
        font-size: 9px;
    }

    .btn-submit {
        padding: 14px;
        font-size: var(--font-base);
        margin-top: 6px;
    }

    .btn-change-program {
        padding: 7px 12px;
        margin-bottom: 8px;
        font-size: 12px;
    }

    .status-section {
        margin-bottom: 12px;
    }

    .btn-status-toggle {
        padding: 10px 14px;
        margin-top: 8px;
        font-size: 12px;
    }

    .detail-row {
        font-size: 12px;
        margin-bottom: 4px;
    }

    /* v5.36: Afisha form — stack on mobile */
    .afisha-form-row {
        flex-direction: column;
        gap: 8px;
    }

    .afisha-form-row .afisha-input {
        width: 100%;
        min-width: 0;
    }

    .afisha-form-row .afisha-input[type="time"],
    .afisha-form-row .afisha-input[type="number"] {
        width: 100%;
    }

    /* Afisha: date + time + auto-time in one row */
    .afisha-form-row .btn-auto-time {
        min-height: 44px;
    }

    .btn-afisha-add {
        width: 100%;
    }

    /* Afisha items: stack actions below */
    .afisha-item {
        flex-direction: column;
        align-items: stretch;
        gap: 8px;
    }

    .afisha-item-actions {
        justify-content: flex-end;
    }

    /* v5.36: History filters — full stack on mobile */
    .history-filter-row {
        flex-direction: column;
        gap: 8px;
    }

    .history-filter-select,
    .history-filter-input[type="text"] {
        width: 100%;
    }

    .history-date-range {
        width: 100%;
    }

    .history-date-range .history-filter-input[type="date"] {
        flex: 1;
        width: auto;
    }

    /* v5.36: History filter buttons — full width row */
    .btn-history-filter,
    .btn-history-reset {
        flex: 1;
        min-height: 44px;
    }

    /* v5.34: Timeline scroll hint */
    .timeline-scroll {
        scroll-snap-type: x proximity;
    }

    /* Category grid */
    .category-grid { grid-template-columns: repeat(3, 1fr); }
    .btn-programs { padding: 8px 12px; font-size: 12px; }
    .modal-catalog { max-height: 90vh; }
}

/* ==========================================
   SMALL MOBILE (<=480px)
   ========================================== */

@media (max-width: 480px) {
    .main-content { padding: 8px; }

    .category-grid { grid-template-columns: repeat(3, 1fr); gap: 6px; }
    .program-icon { min-height: 68px; padding: 10px 4px; }
    .program-icon .icon { font-size: 22px; }
    .program-icon .name { font-size: 9px; }
    .program-duration { font-size: 8px; padding: 1px 4px; }

    /* v7.8.3: Ultra-compact toolbar */
    .control-panel { gap: 4px; padding: 8px; }

    .day-info { display: none; }
    .logo-text h1 { display: none; }
    .logo-img-small { width: 32px; height: 32px; }

    .v32-controls { gap: 4px; }

    /* v7.8.3: Hide toggle labels to save space */
    .toggle-mini-label { display: none; }

    /* v5.34: Full-screen modals on small screens */
    .modal { padding: 0; }
    .modal-content {
        max-width: 100%;
        max-height: 100vh;
        border-radius: 0;
        border: none;
        animation: none;
    }
    .modal-large { max-width: 100%; }
    .modal-catalog { max-width: 100%; max-height: 100vh; border-radius: 0; }

    /* v7.8.3: Compact filters on small screens */
    .status-filter-btn { font-size: 9px; padding: 5px 3px; min-width: 0; min-height: 32px; }
    .period-btn { font-size: 9px; padding: 5px 6px; min-height: 32px; }
    .zoom-controls .zoom-btn { padding: 5px 7px; font-size: 9px; min-height: 32px; }
    .toggle-mini { padding: 4px 5px; min-height: 32px; font-size: 12px; }
    .btn-today { padding: 5px 8px; font-size: 10px; min-height: 34px; }
    .date-controls .btn-nav { width: 36px; height: 34px; min-width: 36px; }
    .btn-export { font-size: 10px; padding: 5px 8px; }
    .btn-menu-toggle { font-size: 10px; padding: 5px 8px; }

    /* v7.8.6: Booking panel extra compact on small screens */
    .panel-header { padding: 10px 12px; }
    .booking-form { padding: 10px 12px; }
    .selected-info { padding: 8px 10px; margin-bottom: 10px; }
    .form-section { margin-bottom: 10px; }
    .form-section label { margin-bottom: 4px; font-size: 10px; }
    .form-section select,
    .form-section input { padding: 8px 9px; border-width: 1.5px; }
    .program-search-input { padding: 7px 9px; border-width: 1.5px; }
    .program-details,
    .custom-program-section,
    .second-animator-section,
    .extra-host-section,
    .kids-count-section { padding: 8px 10px; margin-bottom: 10px; }
    .hosts-warning { padding: 8px 10px; margin-bottom: 10px; }
    .btn-submit { padding: 12px; font-size: 13px; }
    .program-icon { padding: 6px 3px; min-height: 58px; }
    .program-icon .icon { font-size: 20px; margin-bottom: 3px; }
    .program-icon .name { font-size: 8px; }

    /* v5.34: Timeline compact */
    .timeline-scroll { padding: 8px; }
    .time-scale { margin-left: 70px; }
    .line-header { width: 70px; min-width: 70px; }
    .line-name { font-size: 11px; }

    /* Dashboard */
    .dashboard-grid { grid-template-columns: 1fr; }
    .dash-card-value { font-size: 18px; }
    .modal-wide { max-width: 100%; }
}

/* ==========================================
   EXTRA SMALL (<=390px) — iPhone SE, Galaxy A03
   ========================================== */

@media (max-width: 390px) {
    .main-content { padding: 6px; }

    /* v7.8.3: Toolbar ultra-compact */
    .control-panel { gap: 3px; padding: 6px; }
    .date-controls { gap: 3px; }
    .date-controls input[type="date"] {
        padding: 6px 4px;
        font-size: 16px; /* >= 16px prevents iOS auto-zoom on focus */
    }
    .date-controls .btn-nav {
        width: 34px;
        height: 32px;
        min-width: 34px;
        padding: 0;
        font-size: 13px;
    }
    .btn-today {
        padding: 5px 6px;
        font-size: 10px;
        min-height: 32px;
    }

    /* Status filter + period: even smaller */
    .status-filter-btn { font-size: 9px; padding: 4px 2px; min-height: 30px; }
    .period-btn { font-size: 9px; padding: 4px 5px; min-height: 30px; }

    /* Zoom: tighter */
    .zoom-controls .zoom-btn {
        padding: 4px 6px;
        font-size: 9px;
        min-height: 30px;
    }

    /* Toggle labels hidden, toggles compact */
    .toggle-mini { padding: 4px 5px; min-height: 30px; font-size: 12px; }

    /* Timeline: narrower headers */
    .time-scale { margin-left: 60px; }
    .line-header { width: 60px; min-width: 60px; }
    .line-name { font-size: 10px; }

    /* Action buttons: compact */
    .btn-export { font-size: 10px; padding: 4px 6px; min-height: 30px; }
    .btn-menu-toggle { font-size: 10px; padding: 4px 6px; min-height: 30px; }
}

/* ==========================================
   LANDSCAPE PHONES (short viewport) — v5.35
   ========================================== */

@media (max-height: 500px) and (orientation: landscape) {
    .panel-header { padding: 10px 16px; }
    .booking-form { padding: 12px 16px; }
    .form-section { margin-bottom: 12px; }
    .control-panel { padding: 8px 12px; gap: 8px; }
    .modal-content { max-height: 90vh; }
}
