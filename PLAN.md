# PLAN v8.0 ‚Äî –ó–∞–¥–∞—á—ñ (–æ–∫—Ä–µ–º–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞) + –ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–≥—Ä–∞–º (–æ–∫—Ä–µ–º–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞)

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### –ù–æ–≤—ñ —Ñ–∞–π–ª–∏
```
tasks.html        ‚Äî –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–¥–∞—á
programs.html     ‚Äî –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∫–∞—Ç–∞–ª–æ–≥—É –ø—Ä–æ–≥—Ä–∞–º/—Ü—ñ–Ω
js/tasks-page.js  ‚Äî –ª–æ–≥—ñ–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–∞–¥–∞—á
js/programs-page.js ‚Äî –ª–æ–≥—ñ–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø—Ä–æ–≥—Ä–∞–º
css/pages.css     ‚Äî —Å–ø—ñ–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –æ–∫—Ä–µ–º–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ (header, nav, layout, cards)
```

### –ó–º—ñ–Ω–∏ –≤ —ñ—Å–Ω—É—é—á–∏—Ö
```
server.js             ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏ /tasks, /programs
db/index.js           ‚Äî task_templates table, ALTER tasks (type, recurrence)
routes/tasks.js       ‚Äî —Ñ—ñ–ª—å—Ç—Ä ?type=, –∞–≤—Ç–æ-recurring
routes/task-templates.js ‚Äî NEW: CRUD —à–∞–±–ª–æ–Ω—ñ–≤ recurring
services/scheduler.js ‚Äî –∞–≤—Ç–æ-—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è recurring –∑–∞–¥–∞—á —â–æ–¥–µ–Ω–Ω–æ
index.html            ‚Äî –º–µ–Ω—é: –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å –º–æ–¥–∞–ª–æ–∫
js/app.js             ‚Äî –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è
```

---

## 1. –ó–ê–î–ê–ß–Ü (tasks.html)

### –¢–∏–ø–∏ –∑–∞–¥–∞—á (–Ω–æ–≤–µ –ø–æ–ª–µ `type`):
| type | –û–ø–∏—Å | –°—Ç–≤–æ—Ä–µ–Ω–Ω—è | –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è |
|------|-------|-----------|------------|
| `manual` | –ó–≤–∏—á–∞–π–Ω–∞ –∑–∞–¥–∞—á–∞ | –í—Ä—É—á–Ω—É | –í—Ä—É—á–Ω—É |
| `recurring` | –ü–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º | –í—Ä—É—á–Ω—É |
| `afisha` | –ó –∞—Ñ—ñ—à—ñ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (v7.6) | –í—Ä—É—á–Ω—É |
| `auto_complete` | –ê–≤—Ç–æ-–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è | –í—Ä—É—á–Ω—É –∞–±–æ –∞–≤—Ç–æ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞ —É–º–æ–≤–æ—é |

### DB –∑–º—ñ–Ω–∏ ‚Äî ALTER tasks:
```sql
ALTER TABLE tasks ADD COLUMN IF NOT EXISTS type VARCHAR(20) DEFAULT 'manual';
ALTER TABLE tasks ADD COLUMN IF NOT EXISTS template_id INTEGER;
```

### –ù–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è `task_templates` (–¥–ª—è recurring):
```sql
CREATE TABLE IF NOT EXISTS task_templates (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    description TEXT,
    priority VARCHAR(20) DEFAULT 'normal',
    assigned_to VARCHAR(50),
    recurrence_pattern VARCHAR(20) NOT NULL,  -- daily, weekly, weekdays, custom
    recurrence_days VARCHAR(20),              -- –¥–ª—è custom: "1,3,5" (–ø–Ω=1...–Ω–¥=7)
    is_active BOOLEAN DEFAULT TRUE,
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT NOW()
);
```

### Scheduler: –∞–≤—Ç–æ-—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è recurring
- –ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è `checkRecurringTasks()` –≤ services/scheduler.js
- –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —â–æ–¥–µ–Ω–Ω–æ (—è–∫ checkAutoDigest)
- –î–ª—è –∫–æ–∂–Ω–æ–≥–æ active —à–∞–±–ª–æ–Ω—É: –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ pattern –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ –¥–Ω–µ–º
- –î–µ–¥—É–ø–ª—ñ–∫–∞—Ü—ñ—è: –Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —è–∫—â–æ –≤–∂–µ —î task –∑ template_id + —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—è date

### UI —Å—Ç–æ—Ä—ñ–Ω–∫–∏ tasks.html:
- **Header**: —Å–ø—ñ–ª—å–Ω–∏–π (–ª–æ–≥–æ + –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è + user panel)
- **–ü–∞–Ω–µ–ª—å —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**: —Å—Ç–∞—Ç—É—Å, —Ç–∏–ø, –¥–∞—Ç–∞, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π
- **–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á**: –∫–∞—Ä—Ç–∫–∏ –∑ –∫–ª—ñ–∫–æ–º –¥–ª—è –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—É (todo ‚Üí in_progress ‚Üí done)
- **–§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è**: inline –∑–≤–µ—Ä—Ö—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏
- **–°–µ–∫—Ü—ñ—è —à–∞–±–ª–æ–Ω—ñ–≤**: –æ–∫—Ä–µ–º–∞ –≤–∫–ª–∞–¥–∫–∞ –¥–ª—è recurring —à–∞–±–ª–æ–Ω—ñ–≤ (CRUD)
- **–ë–µ–π–¥–∂—ñ —Ç–∏–ø—ñ–≤**: üîÑ recurring, üé≠ afisha, ‚ö° auto_complete, ‚úã manual

### API (–Ω–æ–≤–µ):
- `GET /api/task-templates` ‚Äî —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω—ñ–≤
- `POST /api/task-templates` ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ —à–∞–±–ª–æ–Ω
- `PUT /api/task-templates/:id` ‚Äî –æ–Ω–æ–≤–∏—Ç–∏
- `DELETE /api/task-templates/:id` ‚Äî –≤–∏–¥–∞–ª–∏—Ç–∏
- `GET /api/tasks` ‚Äî –¥–æ–¥–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä ?type=

---

## 2. –ö–ê–¢–ê–õ–û–ì –ü–†–û–ì–†–ê–ú (programs.html)

### UI —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
- **Header**: —Å–ø—ñ–ª—å–Ω–∏–π
- **–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó**: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ñ tabs (–∫–≤–µ—Å—Ç–∏, –∞–Ω—ñ–º–∞—Ü—ñ—è, —à–æ—É, —Ñ–æ—Ç–æ, –ú–ö, –ø—ñ–Ω—å—è—Ç–∏, –∫–∞—Å—Ç–æ–º)
- **–ö–∞—Ä—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º**: —ñ–∫–æ–Ω–∞, –Ω–∞–∑–≤–∞, –∫–æ–¥, —Ü—ñ–Ω–∞, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, –≤–µ–¥—É—á–∏—Ö, –≤—ñ–∫, –æ–ø–∏—Å
- **Inline —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è**: —Ä–æ–∑–∫—Ä–∏—Ç–∏ –∫–∞—Ä—Ç–∫—É –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ–≤
- **–î–æ–¥–∞–≤–∞–Ω–Ω—è**: –∫–Ω–æ–ø–∫–∞ "+" ‚Üí –Ω–æ–≤–∞ –∫–∞—Ä—Ç–∫–∞ —É –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- **Drag-n-drop**: —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è (sort_order) ‚Äî –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è:
- –ú–µ–Ω—é –≤ index.html ‚Üí "üìö –ü—Ä–æ–≥—Ä–∞–º–∏" –≤–µ–¥–µ –Ω–∞ /programs (–∑–∞–º—ñ—Å—Ç—å –º–æ–¥–∞–ª–∫–∏)
- API –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Ç–æ–π —Å–∞–º–∏–π (/api/products)
- –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —è–∫ —ñ —Ä–∞–Ω—ñ—à–µ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑—É—î –¥–∞–Ω—ñ

---

## 3. –ù–ê–í–Ü–ì–ê–¶–Ü–Ø

### –°–ø—ñ–ª—å–Ω–∏–π header (–Ω–∞ –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö):
```html
<nav class="header-nav">
    <a href="/" class="nav-link">üìÖ –¢–∞–π–º–ª–∞–π–Ω</a>
    <a href="/tasks" class="nav-link">üìù –ó–∞–¥–∞—á—ñ</a>
    <a href="/programs" class="nav-link">üìö –ü—Ä–æ–≥—Ä–∞–º–∏</a>
</nav>
```

### –ú–µ–Ω—é (index.html) ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
- "üìù –ó–∞–¥–∞—á—ñ" ‚Üí window.location = '/tasks'
- "üìö –ü—Ä–æ–≥—Ä–∞–º–∏" ‚Üí window.location = '/programs'
- –†–µ—à—Ç–∞ (–Ü—Å—Ç–æ—Ä—ñ—è, –î–∞–π–¥–∂–µ—Å—Ç, –ê—Ñ—ñ—à–∞, –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è) ‚Äî –º–æ–¥–∞–ª–∫–∏ —è–∫ —î

---

## 4. –°–ü–Ü–õ–¨–ù–Ü –ö–û–ú–ü–û–ù–ï–ù–¢–ò

### Auth (shared JS):
- js/config.js + js/api.js + js/auth.js –ø—ñ–¥–∫–ª—é—á–∞—é—Ç—å—Å—è –¥–æ tasks.html —Ç–∞ programs.html
- JWT –∑ localStorage –ø—Ä–∞—Ü—é—î –æ–¥–Ω–∞–∫–æ–≤–æ
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ ‚Üí redirect –Ω–∞ / —è–∫—â–æ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π

### CSS (shared):
- css/base.css ‚Äî –∑–º—ñ–Ω–Ω—ñ, reset, fonts
- css/pages.css ‚Äî NEW: header-nav, page-container, card-grid, filter-bar
- css/dark-mode.css ‚Äî –¥–æ–ø–æ–≤–Ω–∏—Ç–∏ –¥–ª—è –Ω–æ–≤–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫

---

## 5. –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

1. DB –º—ñ–≥—Ä–∞—Ü—ñ—ó (task_templates table, ALTER tasks)
2. routes/task-templates.js (CRUD)
3. services/scheduler.js (recurring auto-creation)
4. css/pages.css (—Å–ø—ñ–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ)
5. programs.html + js/programs-page.js (–ø—Ä–æ—Å—Ç—ñ—à–µ ‚Äî –≤–∂–µ —î API)
6. tasks.html + js/tasks-page.js (—Å–∫–ª–∞–¥–Ω—ñ—à–µ ‚Äî –Ω–æ–≤—ñ —Ç–∏–ø–∏)
7. server.js –º–∞—Ä—à—Ä—É—Ç–∏ (/tasks, /programs)
8. index.html –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è + –º–µ–Ω—é
9. Version bump v8.0 + changelog
